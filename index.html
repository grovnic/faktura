<!DOCTYPE html>
<html lang="bs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Faktura Generator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ“„ E-Faktura Generator | Kontakt: <a href="mailto:electroace@gmail.com">ğŸ“§ electroace@gmail.com</a></h1>

        <div class="button-row">
            <button class="primary" onclick="showCompanySettings()">âš™ï¸ Postavke firme</button>

            <!-- SEGMENTED CONTROL ZA JEZIK -->
            <div class="language-selector">
                <button class="lang-btn active" data-lang="bs" onclick="changeLang('bs')">ğŸ‡§ğŸ‡¦ Bosanski</button>
                <button class="lang-btn" data-lang="en" onclick="changeLang('en')">ğŸ‡¬ğŸ‡§ English</button>
            </div>

            <button onclick="showInstructions()">â“ Upute</button>
            <button id="btnSaveJSON" class="primary" onclick="saveJSON()" disabled>ğŸ’¾ SaÄuvaj JSON</button>
            <button id="btnLoadJSON" class="primary" onclick="document.getElementById('fileInput').click()">ğŸ“‚ UÄitaj JSON</button>
            <input type="file" id="fileInput" accept=".json" onchange="loadJSON(event)" style="display:none;">
            <button class="danger" onclick="clearDocument()">ğŸ—‘ï¸ ObriÅ¡i unos</button>
            <button id="btnDownloadHTML" class="secondary" onclick="downloadHTML()" disabled>ğŸ’¾ Preuzmi HTML</button>
            <button id="btnPrint" class="info-btn" onclick="printToPDF()" disabled>ğŸ–¨ï¸ Print u PDF</button>
        </div>

        <!-- VALIDATION INFO BOX -->
        <div id="validationInfo" class="validation-info" style="display:none;">
            <div class="validation-icon">âš ï¸</div>
            <div class="validation-text">
                <strong>Za aktiviranje dugmadi potrebno je unijeti:</strong>
                <ul>
                    <li>Broj dokumenta</li>
                    <li>Naziv kupca</li>
                    <li>Minimalno 1 stavka sa: <strong>Å¡ifra</strong>, <strong>opis</strong>, <strong>koliÄina > 0</strong>, <strong>cijena > 0</strong></li>
                </ul>
            </div>
        </div>

        <div class="layout">
            <div class="panel">
                <h2>ğŸ“ Podaci o dokumentu</h2>

                <div class="section">
                    <h3>Dokument</h3>
                    <div class="doc-grid-extended">
                        <div class="form-group">
                            <label>Tip dokumenta *</label>
                            <select id="docType" onchange="handleDocTypeChange()">
                                <option value="quote">Ponuda</option>
                                <option value="invoice">Faktura</option>
                                <option value="order">NarudÅ¾benica</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Broj *</label>
                            <input type="text" id="docNum" oninput="validateAndRender()" placeholder="2024/001">
                        </div>
                        <div class="form-group">
                            <label>BF</label>
                            <input type="text" id="bfNum" oninput="render()" placeholder="12345" disabled>
                        </div>
                        <div class="form-group">
                            <label>Valuta</label>
                            <select id="currency" onchange="render()">
                                <option value="KM">KM</option>
                                <option value="EUR">EUR</option>
                                <option value="USD">USD</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Datum izdavanja</label>
                            <input type="date" id="dateIssue" oninput="render()">
                        </div>
                        <div class="form-group">
                            <label>Datum isporuke</label>
                            <input type="date" id="dateDelivery" oninput="render()">
                        </div>
                        <div class="form-group">
                            <label>Rok plaÄ‡anja (dana)</label>
                            <input type="number" id="paymentDays" oninput="render()" placeholder="15" min="0">
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>Kupac</h3>
                    <div class="form-group">
                        <label>Naziv kupca *</label>
                        <input type="text" id="buyerName" oninput="validateAndRender()">
                    </div>
                    <div class="buyer-grid-2">
                        <div class="form-group">
                            <label>Adresa</label>
                            <input type="text" id="buyerAddr" oninput="render()">
                        </div>
                        <div class="form-group">
                            <label>Grad</label>
                            <input type="text" id="buyerCity" oninput="render()">
                        </div>
                        <div class="form-group">
                            <label>DrÅ¾ava</label>
                            <input type="text" id="buyerCountry" oninput="render()">
                        </div>
                    </div>
                    <div class="buyer-grid-3">
                        <div class="form-group">
                            <label>JIB</label>
                            <input type="text" id="buyerJIB" oninput="render()">
                        </div>
                        <div class="form-group">
                            <label>PDV ID</label>
                            <input type="text" id="buyerVAT" oninput="render()">
                        </div>
                        <div class="form-group">
                            <label>Kontakt osoba</label>
                            <input type="text" id="buyerContact" oninput="render()">
                        </div>
                        <div class="form-group">
                            <label>E-mail</label>
                            <input type="email" id="buyerEmail" oninput="render()">
                        </div>
                        <div class="form-group">
                            <label>Referenca</label>
                            <input type="text" id="buyerRef" oninput="render()">
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>Stavke</h3>
                    <div class="item-header">
                        <div id="headerItemNum">R.br.</div>
                        <div id="headerPN">Å ifra</div>
                        <div id="headerItem">Opis</div>
                        <div id="headerQty">Kol.</div>
                        <div id="headerUnit">J.mj.</div>
                        <div id="headerPrice">Cijena</div>
                        <div id="headerDiscount">Popust%</div>
                        <div id="headerVat">PDV%</div>
                        <div></div>
                    </div>
                    <div id="items"></div>
                    <button class="primary" onclick="addItem('','',1,'kom',0,0,17)">+ Dodaj stavku</button>
                </div>

                <div class="section">
                    <h3>Dodatne informacije</h3>
                    <div class="form-group">
                        <label>Napomene</label>
                        <textarea id="paymentTerms" oninput="render()" placeholder="Dodatne napomene za ovaj dokument"></textarea>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h2>ğŸ‘ï¸ Pregled dokumenta</h2>
                <div id="preview"></div>
            </div>
        </div>
    </div>

    <!-- Modal za postavke firme -->
    <div id="companyModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCompanySettings()">&times;</span>
            <h2>âš™ï¸ Postavke firme</h2>
            <div class="form-group">
                <label>Naziv firme *</label>
                <input type="text" id="companyName">
            </div>
            <div class="form-group">
                <label>E-mail *</label>
                <input type="email" id="companyEmail">
            </div>
            <div class="date-grid">
                <div class="form-group">
                    <label>Kontakt osoba</label>
                    <input type="text" id="companyContact">
                </div>
                <div class="form-group">
                    <label>Tel.</label>
                    <input type="tel" id="companyTel" placeholder="+387 61 123 456">
                </div>
            </div>
            <div class="form-group">
                <label>Adresa</label>
                <input type="text" id="companyAddr">
            </div>
            <div class="date-grid">
                <div class="form-group">
                    <label>Grad</label>
                    <input type="text" id="companyCity">
                </div>
                <div class="form-group">
                    <label>DrÅ¾ava</label>
                    <input type="text" id="companyCountry">
                </div>
            </div>
            <div class="date-grid">
                <div class="form-group">
                    <label>JIB</label>
                    <input type="text" id="companyJIB">
                </div>
                <div class="form-group">
                    <label>PDV ID</label>
                    <input type="text" id="companyVAT">
                </div>
            </div>
            <div class="form-group">
                <label>Informacije o banci</label>
                <textarea id="companyBank" placeholder="Banka: ...
IBAN: ...
SWIFT: ..."></textarea>
            </div>
            <div class="form-group">
                <label>Footer tekst</label>
                <textarea id="companyFooter" placeholder="Tekst koji Ä‡e se pojaviti na dnu svakog dokumenta"></textarea>
            </div>
            <div class="form-group">
                <label>Logo (opciono)</label>
                <input type="file" accept="image/*" onchange="previewLogo(event)">
                <div id="logoPreview"></div>
            </div>
            <button class="primary" onclick="saveCompanySettings()">ğŸ’¾ SaÄuvaj</button>
        </div>
    </div>

    <!-- Modal za upute -->
    <div id="instructionsModal" class="modal">
        <div class="modal-content instructions-wide">
            <span class="close" onclick="closeInstructions()">&times;</span>
            <h2>â“ Kako koristiti E-Faktura Generator</h2>

            <h3>ğŸ¢ Korak 1: Postavke firme</h3>
            <p>Prije prvog koriÅ¡tenja, morate unijeti podatke vaÅ¡e firme. Kliknite na <strong>âš™ï¸ Postavke firme</strong>.</p>
            <p><strong>Obavezna polja:</strong></p>
            <ul>
                <li>âœ… Naziv firme</li>
                <li>âœ… E-mail</li>
            </ul>
            <p><strong>Opciona polja:</strong> Kontakt osoba, Tel., Adresa, Grad, DrÅ¾ava, JIB, PDV ID, Informacije o banci, Footer tekst, Logo</p>
            <p><em>Napomena: Podaci se Äuvaju lokalno u vaÅ¡em browseru.</em></p>

            <h3>ğŸ“‹ Korak 2: Tip dokumenta</h3>
            <p>Izaberite tip dokumenta:</p>
            <ul>
                <li><strong>Ponuda</strong> - ponuda cijene (ProdavaÄ â†’ Kupac)</li>
                <li><strong>Faktura</strong> - standardni raÄun (ProdavaÄ â†’ Kupac) - omoguÄ‡ava BF polje</li>
                <li><strong>NarudÅ¾benica</strong> - narudÅ¾ba robe/usluga (NaruÄilac â†’ DobavljaÄ)</li>
            </ul>

            <h3>ğŸ“ Korak 3: Popunjavanje dokumenta</h3>
            <p><strong>Obavezna polja oznaÄena su sa *</strong></p>
            <ul>
                <li><strong>Broj dokumenta *</strong> - npr. 2024/001</li>
                <li><strong>Naziv kupca *</strong></li>
            </ul>
            <p><strong>Opciona polja:</strong> BF (samo za fakturu), Valuta (KM/EUR/USD), Datum izdavanja, Datum isporuke, Rok plaÄ‡anja (dana), ostali podaci o kupcu</p>

            <h3>ğŸ›’ Korak 4: Dodavanje stavki</h3>
            <p>Kliknite <strong>+ Dodaj stavku</strong>. Za svaku stavku unesite:</p>
            <p><strong>Obavezna polja za validaciju:</strong></p>
            <ul>
                <li>âœ… Å ifra (PN) - mora biti popunjena</li>
                <li>âœ… Opis - mora biti popunjen</li>
                <li>âœ… KoliÄina - mora biti veÄ‡a od 0</li>
                <li>âœ… Cijena - mora biti veÄ‡a od 0</li>
            </ul>
            <p><strong>Opciona polja:</strong> J.mj. (jedinica mjere), Popust%, PDV%</p>
            <p><em>Napomena: Minimalno jedna stavka mora biti pravilno popunjena da bi dugmad za Äuvanje bila aktivna.</em></p>

            <h3>ğŸ’¾ Korak 5: ÄŒuvanje i uÄitavanje</h3>
            <p><strong>ğŸ’¾ SaÄuvaj JSON</strong> - Äuva dokument u .json fajl. MoÅ¾ete ga kasnije uÄitati i nastaviti ureÄ‘ivati.</p>
            <p><strong>ğŸ“‚ UÄitaj JSON</strong> - uÄitava prethodno saÄuvani dokument.</p>
            <p><strong>ğŸ—‘ï¸ ObriÅ¡i unos</strong> - briÅ¡e sve uneÅ¡ene podatke i omoguÄ‡ava pravljenje novog dokumenta.</p>
            <p><strong>ğŸ’¾ Preuzmi HTML</strong> - preuzima dokument kao .html fajl koji moÅ¾ete otvoriti u browseru.</p>
            <p><strong>ğŸ–¨ï¸ Print u PDF</strong> - otvara dijalog za print. Odaberite "Save as PDF" da saÄuvate kao PDF fajl.</p>

            <h3>ğŸŒ Jezik</h3>
            <p>Kliknite na <strong>ğŸ‡§ğŸ‡¦ Bosanski</strong> ili <strong>ğŸ‡¬ğŸ‡§ English</strong> da promijenite jezik dokumenta.</p>

            <h3>ğŸ’¡ Savjeti</h3>
            <ul>
                <li>Pregled dokumenta se automatski aÅ¾urira dok unosite podatke</li>
                <li>Dugmad za Äuvanje su neaktivna dok ne unesete broj dokumenta, naziv kupca i minimalno jednu validnu stavku</li>
                <li>BF polje je dostupno samo za tip dokumenta "Faktura"</li>
                <li>Valuta se prikazuje pored iznosa (KM, EUR ili USD)</li>
                <li>Rok plaÄ‡anja se automatski izraÄunava kad unesete broj dana (npr. 15 dana = datum izdavanja + 15 dana)</li>
                <li>Logo moÅ¾ete promijeniti bilo kada u postavkama firme</li>
            </ul>

            <button class="primary" onclick="closeInstructions()">Razumijem</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
